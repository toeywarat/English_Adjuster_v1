<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inversion</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="../js/attempts-client.js"></script>
  <script>const QUIZ_STARTED_AT = Date.now();</script>
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col">
  <!-- Header -->
  <header class="bg-blue-900 text-white py-6 shadow">
    <div class="container mx-auto flex justify-between items-center px-6">
      <h1 class="text-2xl font-bold">English Adjuster</h1>
      <nav>
        <a href="../index.html" class="mr-4 hover:text-yellow-300">Home</a>
        <a href="../lessons/lessons.html" class="mr-4 hover:text-yellow-300">Lessons</a>
        <a href="quiz.html" class="mr-4 hover:text-yellow-300">Quizzes</a>
        <a href="../profile.html" class="text-3xl text-yellow-300">ðŸ‘¤</a>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <main class="container mx-auto px-6 py-12 flex-grow">
    <section class="text-center mb-12">
      <h2 class="text-4xl font-bold text-blue-900 mb-4">Inversion</h2>
      <p class="text-lg text-gray-700">Choose the sentence that correctly uses inversion.</p>
    </section>

    <form id="quizForm" class="space-y-8">
      <!-- Questions will be inserted here -->
    
      <div class="text-center mt-8">
        <button type="button" onclick="checkAnswers()" class="bg-blue-800 text-white px-6 py-3 rounded-lg shadow hover:bg-blue-700 transition">
          Submit Answers
        </button>
      </div>
</form>
    <div id="result" class="text-center mt-8 text-2xl font-bold text-blue-800"></div>


    <div class="text-center mt-8">
      <button onclick="submitQuiz()" class="bg-blue-700 text-white px-6 py-3 rounded hover:bg-blue-800 text-lg font-semibold">Submit</button>
      <p id="score" class="mt-4 text-2xl font-bold text-green-700"></p>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-blue-900 text-white text-center py-4">
    <p>&copy; 2025 Smart Learning System. All rights reserved.</p>
  </footer>

  <!-- Back Button -->
  <button onclick="window.history.back()" class="fixed top-4 left-4 text-white text-2xl hover:text-yellow-300 font-bold py-2 px-4 z-50">
    â‡¦
  </button>

  <script>
    const questions = [
      // EASY
      {
        question: "Which sentence uses inversion correctly?",
        choices: [
          "Never I have seen such beauty.",
          "Never have I seen such beauty.",
          "I have never seen such beauty.",
          "Have I never seen such beauty."
        ],
        correctAnswer: 1
      },
      {
        question: "Choose the correct inversion sentence.",
        choices: [
          "Rarely I go to the theater.",
          "Rarely go I to the theater.",
          "Rarely do I go to the theater.",
          "I rarely go to the theater."
        ],
        correctAnswer: 2
      },
      {
        question: "Hardly ___ when it started raining.",
        choices: [
          "had we left", "we had left", "did we leave", "we leave"],
        correctAnswer: 0
      },
      {
        question: "Not only ___ late, but he also forgot his notes.",
        choices: [
          "he arrived", "did he arrive", "arrived he", "he did arrive"
        ],
        correctAnswer: 1
      },
      {
        question: "No sooner had I sat down ___ the phone rang.",
        choices: [
          "when", "than", "while", "as"
        ],
        correctAnswer: 1
      },
      {
        question: "Little ___ about the surprise party.",
        choices: [
          "does she know", "she knows", "know she", "knew she"
        ],
        correctAnswer: 0
      },
      {
        question: "Only after the meeting ___ what had happened.",
        choices: [
          "he understood", "did he understand", "understood he", "he did understand"
        ],
        correctAnswer: 1
      },
      {
        question: "Seldom ___ such a talented singer.",
        choices: [
          "I heard", "have I heard", "I have heard", "did I heard"
        ],
        correctAnswer: 1
      },
      {
        question: "Under no circumstances ___ late.",
        choices: [
          "you should arrive", "should you arrive", "arrive you should", "you arrive should"
        ],
        correctAnswer: 1
      },
      {
        question: "Only when he left ___ how much he meant to her.",
        choices: [
          "did she realize", "she realized", "realized she", "does she realize"
        ],
        correctAnswer: 0
      },

      // MEDIUM
      {
        question: "So beautiful ___ that everyone admired her.",
        choices: [
          "she was", "was she", "is she", "she is"
        ],
        correctAnswer: 1
      },
      {
        question: "Scarcely had I closed my eyes ___ I heard a noise.",
        choices: [
          "than", "when", "then", "as"
        ],
        correctAnswer: 1
      },
      {
        question: "Not until I spoke to her ___ the truth.",
        choices: [
          "I realized", "realized I", "did I realize", "do I realize"
        ],
        correctAnswer: 2
      },
      {
        question: "On no account ___ the equipment be touched.",
        choices: [
          "must", "should", "can", "will"
        ],
        correctAnswer: 1
      },
      {
        question: "Nowhere else ___ such a beautiful landscape.",
        choices: [
          "you will find", "will you find", "find you will", "do you find"
        ],
        correctAnswer: 1
      },
      {
        question: "At no time ___ he accept the offer.",
        choices: [
          "did", "does", "had", "was"
        ],
        correctAnswer: 0
      },

      // HARD
      {
        question: "Not for one moment ___ she consider quitting.",
        choices: [
          "did", "has", "was", "does"
        ],
        correctAnswer: 0
      },
      {
        question: "So loudly ___ that everyone turned to look.",
        choices: [
          "she spoke", "did she speak", "she did speak", "spoken she"
        ],
        correctAnswer: 1
      },
      {
        question: "Only by working hard ___ his goals.",
        choices: [
          "he can achieve", "achieve he can", "can he achieve", "he achieve can"
        ],
        correctAnswer: 2
      },
      {
        question: "No sooner had we arrived ___ it started to snow.",
        choices: [
          "when", "as", "than", "before"
        ],
        correctAnswer: 2
      }
    ];

    function submitQuiz() {
      const form = document.getElementById("quizForm");
      let score = 0;
      questions.forEach((q, index) => {
        const selected = form.querySelector(`input[name="q${index}"]:checked`);
        if (selected && parseInt(selected.value) === q.correctAnswer) {
          score++;
        }
      });
      document.getElementById("score").innerText = `Your score: ${score} / ${questions.length}`;
    }

    // Render questions
    const form = document.getElementById("quizForm");
    questions.forEach((q, index) => {
      const block = document.createElement("div");
      block.innerHTML = `
        <div class="bg-white p-6 rounded-lg shadow">
          <h3 class="text-lg font-semibold mb-4">Q${index + 1}. ${q.question}</h3>
          ${q.choices.map((choice, i) => `
            <label class="block mb-2">
              <input type="radio" name="q${index}" value="${i}" class="mr-2">
              ${choice}
            </label>
          `).join('')}
        </div>
      `;
      form.appendChild(block);
    });
  </script>

<script>
  async function checkAnswers() {
    const form = document.getElementById('quizForm') || document.querySelector('form');
    const answers = form ? form.querySelectorAll('input[type="radio"]:checked') : [];
    const total = (form ? form.querySelectorAll('.bg-white.p-6.rounded-lg.shadow').length : 0) || (form ? form.querySelectorAll('h3').length : 0) || answers.length || 20;
    let score = 0;
    answers.forEach(ans => { if (ans.value === "true") score++; });
    const result = document.getElementById('result');
    if (result) result.innerText = `You got ${score} out of ${total} correct.`;

    try {
      const items = window.__attemptsClient ? window.__attemptsClient.buildItemsFromForm(form) : [];
      await (window.__attemptsClient ? window.__attemptsClient.saveAttempt({
        topic: document.title || "Inversion",
        quizType: "topic",
        score,
        total: items.length || total,
        durationSec: Math.floor((Date.now() - (window.QUIZ_STARTED_AT || Date.now())) / 1000),
        startedAt: new Date(window.QUIZ_STARTED_AT || Date.now()).toISOString(),
        items
      }) : Promise.resolve());
      console.log("Attempt saved!");
    } catch (e) {
      console.error("Failed to save attempt:", e);
    }
    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
  }
</script>
</body>
</html>
