<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pretest Results - English Adjuster</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-blue-900 text-white py-6 shadow">
    <div class="container mx-auto flex justify-between items-center px-6">
      <h1 class="text-2xl font-bold">English Adjuster</h1>
      <nav>
        <a href="../index.html" class="mr-4 hover:text-yellow-300">Home</a>
        <a href="../lessons/lessons.html" class="mr-4 hover:text-yellow-300">Lessons</a>
        <a href="../quizzes/quiz.html" class="hover:text-yellow-300">Quizzes</a>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <main class="flex-grow container mx-auto px-6 py-12">
    <div class="bg-white rounded-lg shadow p-8 max-w-2xl mx-auto text-center">
      <h2 class="text-3xl font-bold text-blue-900 mb-6">Your Pretest Results</h2>

      <div id="score-summary" class="text-xl space-y-4 mb-6 text-left"></div>

      <p id="total-score" class="text-2xl font-bold text-green-700 mt-4"></p>

      <div class="mt-8 space-x-4">
        <a href="../index.html" class="bg-gray-600 text-white px-6 py-3 rounded hover:bg-gray-700">ğŸ  Back to Home</a>
        <a href="../lessons/lessons.html" class="bg-blue-700 text-white px-6 py-3 rounded hover:bg-blue-800">ğŸ“˜ Start Learning</a>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-blue-900 text-white text-center py-4 mt-8">
    <p>&copy; 2025 Smart Learning System. All rights reserved.</p>
  </footer>

  <!-- Script -->
  <script>
    const grammar = parseInt(sessionStorage.getItem("grammarScore")) || 0;
    const vocab = parseInt(sessionStorage.getItem("vocabScore")) || 0;
    const reading = parseInt(sessionStorage.getItem("readingScore")) || 0;
    const writing = parseInt(sessionStorage.getItem("writingScore")) || 0;

    const summary = document.getElementById("score-summary");
    summary.innerHTML = `
      <p>ğŸ“ Grammar: <strong>${grammar} / 18</strong></p>
      <p>ğŸ“š Vocabulary: <strong>${vocab} / 15</strong></p>
      <p>ğŸ“– Reading: <strong>${reading} / 15</strong></p>
      <p>âœï¸ Writing: <strong>${writing} / 12</strong></p>
    `;

    const total = grammar + vocab + reading + writing;
    const totalScore = document.getElementById("total-score");
    totalScore.textContent = `ğŸ‰ Total Score: ${total} / 60`;
    
    const token = localStorage.getItem("token");
    if (token) {
      fetch("http://localhost:5500/api/pretest-score", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: `Bearer ${token}`
        },
        body: JSON.stringify({ grammar, vocab, reading, writing })
      })
        .then(res => res.json())
        .then(data => {
          console.log("âœ… à¸šà¸±à¸™à¸—à¸¶à¸à¸„à¸°à¹à¸™à¸™à¹à¸¥à¹‰à¸§:", data);
      })
      .catch(err => {
        console.error("âŒ à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸ªà¹ˆà¸‡à¸„à¸°à¹à¸™à¸™:", err);
      });
  } else {
    console.warn("âš ï¸ à¹„à¸¡à¹ˆà¸à¸š token: à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰ login à¸«à¸£à¸·à¸­ signup");
  }
  </script>
</body>
</html>
