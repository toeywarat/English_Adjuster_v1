<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pretest - Writing Part</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-blue-900 text-white py-6 shadow">
    <div class="container mx-auto flex justify-between items-center px-6">
      <h1 class="text-2xl font-bold">English Adjuster</h1>
      <nav>
        <a href="../index.html" class="mr-4 hover:text-yellow-300">Home</a>
        <a href="../lessons/lessons.html" class="mr-4 hover:text-yellow-300">Lessons</a>
        <a href="../quizzes/quiz.html" class="hover:text-yellow-300">Quizzes</a>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <main class="flex-grow container mx-auto px-6 py-12">
    <h2 class="text-3xl font-bold text-blue-900 text-center mb-8">Writing Skills</h2>

    <form id="writing-form" class="space-y-8 max-w-3xl mx-auto bg-white p-6 rounded-lg shadow-md">
      <!-- Writing Questions -->
      <div>
        <p class="font-semibold">1. Choose the correct sentence:</p>
        <label class="block mt-2"><input type="radio" name="q1" value="a" required /> I have three favorite colors: blue, green and red.</label>
        <label class="block"><input type="radio" name="q1" value="b" /> I have three favorite colors, blue green, and red.</label>
        <label class="block"><input type="radio" name="q1" value="c" /> I have three favorite colors; blue, green, and red.</label>
        <label class="block"><input type="radio" name="q1" value="d" /> I have three favorite colors: blue, green, and red.</label>
      </div>

      <div>
        <p class="font-semibold">2. Choose the correct version:</p>
        <label class="block mt-2"><input type="radio" name="q2" value="a" required /> Its raining outside.</label>
        <label class="block"><input type="radio" name="q2" value="b" /> It's raining outside.</label>
        <label class="block"><input type="radio" name="q2" value="c" /> Its' raining outside.</label>
        <label class="block"><input type="radio" name="q2" value="d" /> Its raining, outside.</label>
      </div>

      <div>
        <p class="font-semibold">3. Which sentence uses the semicolon correctly?</p>
        <label class="block mt-2"><input type="radio" name="q3" value="a" required /> She studied hard; and she passed the test.</label>
        <label class="block"><input type="radio" name="q3" value="b" />  She studied hard: she passed the test.</label>
        <label class="block"><input type="radio" name="q3" value="c" /> She studied hard; she passed the test.</label>
        <label class="block"><input type="radio" name="q3" value="d" /> She studied hard; but passed.</label>
      </div>

      <div>
        <p class="font-semibold">4. Select the correct punctuation:</p>
        <label class="block mt-2"><input type="radio" name="q4" value="b" required /> She said, “Let’s go now.”</label>
        <label class="block"><input type="radio" name="q4" value="a" /> She said “Let’s go now”.</label>
        <label class="block"><input type="radio" name="q4" value="c" /> She said. “Let’s go now.”</label>
        <label class="block"><input type="radio" name="q4" value="d" /> She said, “Let’s go now”.</label>
      </div>

      <div>
        <p class="font-semibold">5. Choose the correct use of apostrophes:</p>
        <label class="block mt-2"><input type="radio" name="q5" value="a" required /> I bought apples bananas oranges and pears.</label>
        <label class="block"><input type="radio" name="q5" value="b" /> I bought apples, bananas, oranges and pears.</label>
        <label class="block"><input type="radio" name="q5" value="c" /> I bought apples, bananas, oranges, and pears.</label>
        <label class="block"><input type="radio" name="q5" value="d" /> I bought, apples bananas oranges, and pears.</label>
      </div>
      
      <div>
        <p class="font-semibold">6. Pick the correctly punctuated sentence:</p>
        <label class="block mt-2"><input type="radio" name="q6" value="a" required /> I love reading, writing and drawing.</label>
        <label class="block"><input type="radio" name="q6" value="b" /> I love reading writing and drawing.</label>
        <label class="block"><input type="radio" name="q6" value="c" /> I love reading, writing, and drawing.</label>
        <label class="block"><input type="radio" name="q6" value="d" /> I love reading, writing and, drawing.</label>
      </div>

      <div>
        <p class="font-semibold">7. Choose the correct sentence:</p>
        <label class="block mt-2"><input type="radio" name="q7" value="a" required /> The team has one goal: win the championship.</label>
        <label class="block"><input type="radio" name="q7" value="b" /> The team has one goal; to win the championship.</label>
        <label class="block"><input type="radio" name="q7" value="c" /> The team has one goal—to win the championship.</label>
        <label class="block"><input type="radio" name="q7" value="d" /> The team has one goal, win the championship.</label>
      </div>

      <div>
        <p class="font-semibold">8. Which sentence is correct?</p>
        <label class="block mt-2"><input type="radio" name="q8" value="a" required /> My friends' car is parked outside.</label>
        <label class="block"><input type="radio" name="q8" value="b" /> My friend's car is parked outside.</label>
        <label class="block"><input type="radio" name="q8" value="c" /> My friend car's is parked outside.</label>
        <label class="block"><input type="radio" name="q8" value="d" /> My friend cars is parked outside.</label>
      </div>

      <div>
        <p class="font-semibold">9. Choose the correct punctuation:</p>
        <label class="block mt-2"><input type="radio" name="q9" value="a" required /> I was tired, I kept working.</label>
        <label class="block"><input type="radio" name="q9" value="b" /> I was tired; I kept working.</label>
        <label class="block"><input type="radio" name="q9" value="c" /> I was tired: but I kept working.</label>
        <label class="block"><input type="radio" name="q9" value="d" /> I was tired. But, I kept working.</label>
      </div>

      <div>
        <p class="font-semibold">10. Pick the best sentence:</p>
        <label class="block mt-2"><input type="radio" name="q10" value="a" required /> She didn’t enjoy the movie; however it was well made.</label>
        <label class="block"><input type="radio" name="q10" value="b" /> She didn’t enjoy the movie, however, it was well made.</label>
        <label class="block"><input type="radio" name="q10" value="c" /> She didn’t enjoy the movie. However, it was well made.</label>
        <label class="block"><input type="radio" name="q10" value="d" /> She didn’t enjoy the movie however; it was well made.</label>
      </div>

      <div>
        <p class="font-semibold">11. Choose the sentence with correct punctuation:</p>
        <label class="block mt-2"><input type="radio" name="q11" value="a" required /> The teacher said “No homework tonight.”</label>
        <label class="block"><input type="radio" name="q11" value="b" /> The teacher said, “No homework tonight.”</label>
        <label class="block"><input type="radio" name="q11" value="c" /> The teacher said “No homework tonight”.</label>
        <label class="block"><input type="radio" name="q11" value="d" /> The teacher said; “No homework tonight.”</label>
      </div>

      <div>
        <p class="font-semibold">12. Select the correct punctuation:</p>
        <label class="block mt-2"><input type="radio" name="q12" value="a" required /> Maria who is my cousin, lives in Paris.</label>
        <label class="block"><input type="radio" name="q12" value="b" /> Maria, who is my cousin lives in Paris.</label>
        <label class="block"><input type="radio" name="q12" value="c" /> Maria who, is my cousin, lives in Paris.</label>
        <label class="block"><input type="radio" name="q12" value="d" /> Maria, who is my cousin, lives in Paris.</label>
      </div>
      
      

      <button type="submit" class="bg-green-600 hover:bg-green-700 text-white py-3 px-6 rounded-lg font-bold">
        Submit
      </button>

      <p id="result" class="mt-4 text-center font-semibold text-blue-700"></p>
    </form>
  </main>

  <!-- Footer -->
  <footer class="bg-blue-900 text-white text-center py-4 mt-8">
    <p>&copy; 2025 Smart Learning System. All rights reserved.</p>
  </footer>

  <script>
  const BACKEND_URL = "https://english-adjuster-v1.onrender.com"; // ← my Render backend URL
  
  document.getElementById("writing-form").addEventListener("submit", async function (e) {
    e.preventDefault();

    const correctAnswers = {
      q1: "d", q2: "b", q3: "c", q4: "a", q5: "b",
      q6: "c", q7: "c", q8: "b", q9: "b", q10: "c",
      q11: "b", q12: "d"
    };

    let score = 0, answered = 0;
	let userAnswers = {};	
    for (let key in correctAnswers) {
      const selected = document.querySelector(`input[name="${key}"]:checked`);
    //    if (selected) {
    //      answered++;
    //      if (selected.value.trim().toLowerCase() === correctAnswers[key]) score++;
    //    }
    //}

    //  if (answered < Object.keys(correctAnswers).length) {
    //   alert("กรุณาตอบให้ครบทั้ง 12 ข้อก่อนส่งแบบทดสอบ");
    //    return;
    //}

	  if (!selected) {
	    alert("กรุณาตอบให้ครบทั้ง 15 ข้อก่อนส่งแบบทดสอบ");
	    return;
      }
      userAnswers[key] = selected.value;
      if (selected.value.trim().toLowerCase() === correctAnswers[key]) score++;	  

    // Save locally 
    sessionStorage.setItem("writingScore", score);
	
	// Send to backend
	const token = localStorage.getItem("token"); // if using JWT
	try {
		const res = await fetch(`${BACKEND_URL}/api/pretest/vocab`, {
		method: "POST",
		headers: {
		"Content-Type": "application/json",
		"Authorization": token ? `Bearer ${token}` : ""
		},
		body: JSON.stringify({
		score,
		answers: userAnswers
		})
	});
	const data = await res.json();
	console.log("Backend response:", data);
	} catch (err) {
		console.error("Could not send score to backend:", err);
	}	
	
	// Redirect to result part			
    window.location.href = "pretest-result.html";
  });
</script>

</body>
</html>
